---
title: Largest prime factor
index: 3
tags:
  https://img.shields.io/badge/Euler-3-brightgreen.svg?style=for-the-badge: https://projecteuler.net/problem=3
  https://img.shields.io/badge/Languages-3-blueviolet.svg?style=for-the-badge:
downloads:
  Overview: https://projecteuler.net/overview=003
---

> The prime factors of $13195$ are $5$, $7$, $13$ and $29$. What is the largest
> prime factor of the number $600851475143$?

### Solution

### Code

%%%

Ada
```ada
with Ada.Text_IO; use Ada.Text_IO;
with Ada.Numerics.Generic_Elementary_Functions;
with Ada.Command_Line; use Ada.Command_Line;

procedure P3 is
  package Value_Functions is new Ada.Numerics.Generic_Elementary_Functions (
  Standard.Float);
  use Value_Functions;
  n: Long_Integer := 600851475143;
  last_factor: Long_Integer := 1;
  factor: Long_Integer := 3;
  max_factor: Long_Integer;
begin
  if Argument_Count >= 1 then
    n := Long_Integer'Value(Argument(1));
  end if;
  if n mod 2 = 0 then
    last_factor := 2;
    n := n / 2;
    while n mod 2 = 0 loop
      n := n / 2;
    end loop;
  end if;
  max_factor := Long_Integer(Sqrt(Float(n)));
  while n > 1 and factor <= max_factor loop
    if n mod factor = 0 then
      n := n / factor;
      last_factor := factor;
      while n mod factor = 0 loop
        n := n / factor;
      end loop;
      max_factor := Long_Integer(Sqrt(Float(n)));
    end if;
    factor := factor + 2;
  end loop;
  if n /= 1 then
    last_factor := n;
  end if;
  Put_Line(Long_Integer'Image(last_factor));
end P3;
```

Cpp
```cpp
#include <cmath>
#include <cstdlib>
#include <iostream>

int main(int argc, char *argv[]) {
  unsigned long int n = 600851475143;
  if (argc > 1) {
    n = atoi(argv[1]);
  }
  unsigned long int last_factor = 1;
  if (n % 2 == 0) {
    last_factor = 2;
    n /= 2;
    while (n % 2 == 0) {
      n /= 2;
    }
  }
  unsigned long int factor = 3;
  unsigned long int max_factor = sqrt(n);
  while (n > 1 && factor <= max_factor) {
    if (n % factor == 0) {
      n /= factor;
      last_factor = factor;
      while (n % factor == 0) {
        n /= factor;
      }
      max_factor = sqrt(n);
    }
    factor += 2;
  }
  if (n != 1) {
    last_factor = n;
  }
  std::cout << last_factor << std::endl;
}
```

Fortran
```fortran
program p3
  integer(kind=8) :: n = 600851475143_8
  integer(kind=8) :: last_factor = 1
  integer(kind=8) :: factor = 3
  integer(kind=8) :: max_factor = 0
  character(len=32) :: arg
  if (command_argument_count() .gt. 1) then
    call get_command_argument(1, arg)
    read(arg,*) n
  endif
  if (mod(n, 2) .eq. 0) then
    last_factor = 2
    n = n / 2
    do while (mod(n, 2) .eq. 0)
      n = n / 2
    enddo
  endif
  max_factor = int(sqrt(real(n)))
  do while (n .gt. 1 .and. factor .le. max_factor)
    if (mod(n, factor) .eq. 0) then
      n = n / factor
      last_factor = factor
      do while (mod(n, factor) .eq. 0)
        n = n / factor
      enddo
      max_factor = int(sqrt(real(n)))
    endif
    factor = factor + 2
  enddo
  if (n .ne. 1) then
    last_factor = n
  endif
  print *,last_factor
end program p3
```

%%%
